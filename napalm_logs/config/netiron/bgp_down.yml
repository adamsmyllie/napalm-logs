messages:
  - error: BGP_NEIGHBOR_DOWN_DEFAULT_VRF
    tag: BGP
    values:
      peer: ([\w\d:\.]+)
      reason: ([^\(\)]+)
    line: 'Peer (VRF: default-vrf) {peer} DOWN ({reason})'
    model: openconfig-bgp
    mapping:
      variables:
        bgp//neighbors//neighbor//{peer}//state//session-state-change-event: reason
      static:
        bgp//neighbors//neighbor//{peer}//state//session-state: IDLE
        bgp//neighbors//neighbor//{peer}//state//session-state-old: ESTABLISHED
  - error: BGP_NEIGHBOR_DOWN_WITHIN_VRF
    tag: BGP
    values:
      instance: (\w+)
      peer: ([\w\d:\.]+)
      reason: ([^\(\)]+)
    line: 'Peer (VRF: {instance}) {peer} DOWN ({reason})'
    model: openconfig-network-instance
    mapping:
      variables:
        network-instances//network-instance//{instance}//protocols//bgp//bgp//neighbors//neighbor//{peer}//state//session-state-change-event: reason
      static:
        network-instances//network-instance//{instance}//protocols//bgp//bgp//neighbors//neighbor//{peer}//state//session-state: IDLE
        network-instances//network-instance//{instance}//protocols//bgp//bgp//neighbors//neighbor//{peer}//state//session-state-old: ESTABLISHED
